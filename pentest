#!/usr/bin/env python

# Usage ./pentest host testname interface

import sys
from pwn import *
import subprocess
import argparse
import os

#Custom Imports
import lib.init.filesystem
import lib.enum.scan

parser = argparse.ArgumentParser()
parser.add_argument('--host', action='store')
parser.add_argument('--project', action='store')

if not len(sys.argv) > 1:
	parser.print_help()
	exit()

args = parser.parse_args()

host = args.host
project = args.project
cmd = "-sV localhost"

print "Pentest Framework // @porthunter"

def createScripts():
	print "[i] Creating Scripts for "+project


def ncConnect():
	print "1"

def createMetasploitHandlerScript(payload, lhost, lport):
	script = "use exploit/multi/handler\n"
	script += "set PAYLOAD "+payload+"\n"
	script += "set LHOST "+lhost+"\n"
	script += "set LPORT "+lport+"\n"
	script += "set ExitOnSession false\n"
	script += "exploit -j -z"
	print script

command = 'sudo aptitude update && sudo aptitude safe-upgrade'
terminal = ['gnome-terminal']
terminal.extend(['--tab', '-e', '''
    bash -c '
        nmap -sC -sV host -p 8080
	exec bash
    '
''' % locals()])
subprocess.call(terminal)

lib.init.filesystem.create(project)
#os.system("dirb http://"+host+":8080")
createScripts()
lib.enum.scan.nmapScan(host, project)
#createMetasploitHandlerScript("php/meterpreter/reverse_tcp", "10.10.10.12", "1337")

#while 1==1:
#	print "waiting..."
